<!doctype html><html><head><link rel=stylesheet href=https://hybrid-cloud-patterns.io/sass/patternfly.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=https://hybrid-cloud-patterns.io/sass/patternfly-addons.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v6.3.0/css/solid.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v6.3.0/css/fontawesome.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v6.3.0/css/brands.css><title>Importing a cluster | Hybrid Cloud Patterns</title></head><body><div class=pf-c-page><header class=pf-c-page__header><div class=pf-c-page__header-brand><a href=/ class=pf-c-page__header-brand-link><img src=/images/hybrid_cloud_patterns.png alt="Hybrid Cloud Patterns"></a></div><div class=pf-c-page__header-tools><nav class="pf-c-nav pf-m-horizontal" role=navigation><ul class=pf-c-nav__list><li class=pf-c-nav__item><a class=pf-c-nav__link href=/patterns/ title=Patterns>Patterns</a></li><li class="pf-c-nav__item pf-m-current"><a class=pf-c-nav__link href=/learn/ title=Learn>Learn</a></li><li class=pf-c-nav__item><a class=pf-c-nav__link href=/contribute/ title=Contribute>Contribute</a></li><li class=pf-c-nav__item><a class=pf-c-nav__link href=/blog/ title=Blog>Blog</a></li><li class=pf-c-nav__item><a class=pf-c-nav__link href=/ci/ title=Status>Status</a></li></ul></nav></div></header><div class=pf-c-page__sidebar><div class=pf-c-page__sidebar-body><div class="pf-l-flex filter-title-div"><span class="pf-c-title pf-m-md filter-title pf-l-flex__item pf-m-grow">Menu</span></div><div class="pf-c-select pf-m-expanded"><div class=pf-c-select__menu><div class="pf-c-nav pf-m-light"><ul class=pf-c-nav__list><li class="pf-c-nav__item pf-m-expanded"><a href=/learn/about/ class=pf-c-nav__link>Hybrid Cloud Patterns</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=/learn/quickstart/ class=pf-c-nav__link>Patterns quick start</a><section class=pf-c-nav__subnav><ul class=pf-c-nav__list><li class="pf-c-nav__item pf-m-expanded"><a href=/learn/importing-a-cluster/ class="pf-c-nav__link pf-m-current">Importing a cluster</a></li></ul></section></li><li class="pf-c-nav__item pf-m-expanded"><a href=/learn/infrastructure/ class=pf-c-nav__link>Infrastructure</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=/learn/workflow/ class=pf-c-nav__link>Workflow</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=/learn/secrets/ class=pf-c-nav__link>Secrets</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=/learn/faq/ class=pf-c-nav__link>FAQ</a></li></ul></div></div></div></div></div><main class=pf-c-page__main tabindex=0 data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=50><section class="pf-c-page__main-section pf-m-fill"><div class=pf-u-display-flex><div class="pf-c-content min-height"><div class=sect1><h2 id=importing-a-cluster><a class=anchor href=#importing-a-cluster></a>Importing a managed cluster</h2><div class=sectionbody><div class=paragraph><p>Many validated patterns require importing a cluster into a managed group. These groups have specific application sets that will be deployed and managed. Some examples are factory clusters in the Industrial Edge pattern, or development clusters in Multi-cluster DevSecOps pattern.</p></div><div class=paragraph><p>Red Hat Advanced Cluster Management (RHACM) can be used to create a cluster of a specific cluster group type. You can deploy a specific cluster that way if you have RHACM set up with credentials for deploying clusters. However in many cases an OpenShift cluster has already been created and will be imported into the set of clusters that RHACM is managing.</p></div><div class=paragraph><p>While you can create and deploy in this manner this section concentrates on importing an existing cluster and designating a specific managed cluster group type.</p></div><div class=paragraph><p>To deploy a cluster that can be imported into RHACM, use the <code>openshift-install</code> program provided at <a href=https://console.redhat.com/openshift/create>console.redhat.com</a>. You will need login credentials.</p></div></div></div><div class=sect1><h2 id=_importing_a_cluster_using_the_rhacm_user_interface><a class=anchor href=#_importing_a_cluster_using_the_rhacm_user_interface></a>Importing a cluster using the RHACM User Interface</h2><div class=sectionbody><div class=sect2><h3 id=_getting_to_the_rhacm_user_interface><a class=anchor href=#_getting_to_the_rhacm_user_interface></a>Getting to the RHACM user interface</h3><div class=paragraph><p>After ACM is installed a message regarding a "Web console update is available" will be displayed. Click on the "Refresh web console" link.</p></div><div class=paragraph><p>On the upper-left side you’ll see a pull down labeled "local-cluster". Select "All Clusters" from this pull down. This will navigate to the RHACM console and to its "Clusters" section</p></div><div class=paragraph><p>Select the "Import cluster" option.</p></div></div><div class=sect2><h3 id=_importing_the_cluster><a class=anchor href=#_importing_the_cluster></a>Importing the cluster</h3><div class=paragraph><p>On the "Import an existing cluster" page, enter the cluster name (arbitrary) and choose Kubeconfig as the "import mode". Add the tag <code>clusterGroup=</code> using the appropriate cluster group specified in the pattern. Press <code>Import</code>.</p></div><div class=paragraph><p>Using this method, you are done. Skip to the section in your pattern documentation that describes how you can confirm the pattern deployed correctly on the managed cluster.</p></div></div></div></div><div class=sect1><h2 id=_other_potential_import_tools><a class=anchor href=#_other_potential_import_tools></a>Other potential import tools</h2><div class=sectionbody><div class=paragraph><p>There are a two other known ways to join a cluster to the RHACM hub. These methods are not supported but have been tested once. The patterns team no longer tests these methods. If these methods become supported we will maintain the documentation here.</p></div><div class=ulist><ul><li><p>Using the <a href=https://github.com/stolostron/cm-cli>cm-cli</a> tool</p></li><li><p>Using the <a href=https://github.com/open-cluster-management-io/clusteradm>clusteradm</a> tool</p></li></ul></div></div></div><div class=sect1><h2 id=_importing_a_cluster_using_the_cm_cli_tool><a class=anchor href=#_importing_a_cluster_using_the_cm_cli_tool></a>Importing a cluster using the cm-cli tool</h2><div class=sectionbody><div class="olist arabic"><ol class=arabic><li><p>Install the cm-cli (<code>cm</code>) (cluster management) command-line tool. See installation instructions here: <a href=https://github.com/open-cluster-management/cm-cli/#installation>cm-cli installation</a></p></li><li><p>Obtain the KUBECONFIG file from the managed cluster.</p></li><li><p>On the command-line login into the hub/datacenter cluster (use <code>oc login</code> or export the KUBECONFIG).</p></li><li><p>Run the following command:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=terminal><span class=gp>cm attach cluster --cluster &lt;cluster-name&gt;</span><span class=w> </span><span class=nt>--cluster-kubeconfig</span> &lt;path-to-KUBECONFIG&gt;</code></pre></div></div></li></ol></div></div></div><div class=sect1><h2 id=_importing_a_cluster_using_clusteradm_tool><a class=anchor href=#_importing_a_cluster_using_clusteradm_tool></a>Importing a cluster using <code>clusteradm</code> tool</h2><div class=sectionbody><div class=paragraph><p>You can also use <code>clusteradm</code> to join a cluster. The following instructions explain what needs to be done. <code>clusteradm</code> is still in testing.</p></div><div class="olist arabic"><ol class=arabic><li><p>To deploy a edge cluster you will need to get the hub/datacenter cluster’s token. You will need to <a href=https://github.com/open-cluster-management-io/clusteradm#install-the-clusteradm-command-line>install <code>clusteradm</code></a>. When it is installed run the following on existing <strong>hub/datacenter</strong> cluster:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=terminal><span class=go>clusteradm get token</span></code></pre></div></div></li><li><p>When you run the <code>clusteradm</code> command above it replies with the token and also shows you the command to use on the managed. Login to the managed cluster with either of the following methods:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=terminal><span class=go>oc login</span></code></pre></div></div><div class=paragraph><p>or</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=terminal><span class=gp>export KUBECONFIG=~/&lt;path-to-kubeconfig&gt;</span></code></pre></div></div></li><li><p>Then request to that the managed join the datacenter hub.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=terminal><span class=gp>clusteradm join --hub-token &lt;token from clusteradm get token command &gt;</span><span class=w> </span>&lt;managed-cluster-name&gt;</code></pre></div></div></li><li><p>Back on the hub cluster accept the join request.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=terminal><span class=gp>clusteradm accept --clusters &lt;managed-cluster-name&gt;</span></code></pre></div></div></li></ol></div></div></div><div class=sect1><h2 id=_designate_the_new_cluster_as_a_devel_site><a class=anchor href=#_designate_the_new_cluster_as_a_devel_site></a>Designate the new cluster as a devel site</h2><div class=sectionbody><div class=paragraph><p>If you use the command line tools above you need to explicitly indicate that the imported cluster is part of a specific clusterGroup. If you haven’t tagged the cluster as <code>clusterGroup=&lt;managed-cluster-group></code> then do that now. Some examples of <code>clusterGroup</code> are <code>factory</code>, <code>devel</code>, or <code>prod</code>.</p></div><div class=paragraph><p>We do this by adding the label referenced in the managedSite’s <code>clusterSelector</code>.</p></div><div class="olist arabic"><ol class=arabic><li><p>Find the new cluster.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=terminal><span class=go>oc get managedclusters.cluster.open-cluster-management.io</span></code></pre></div></div></li><li><p>Apply the label.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=terminal><span class=gp>oc label managedclusters.cluster.open-cluster-management.io/&lt;your-cluster&gt;</span><span class=w> </span><span class=nv>clusterGroup</span><span class=o>=</span>&lt;managed-cluster-group&gt;</code></pre></div></div></li></ol></div></div></div></div><aside class="pf-c-jump-links pf-m-vertical sticky pf-m-expandable pf-m-non-expandable-on-2xl" aria-label="Table of contents"><div class=pf-c-jump-links__header><div class=pf-c-jump-links__label><h1>Table of Contents</h1></div></div><nav id=TableOfContents><ul class=pf-c-jump-links__list><li class=pf-c-jump-links__item><ul class=pf-c-jump-links__list><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#importing-a-cluster>Importing a managed cluster</a></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#_importing_a_cluster_using_the_rhacm_user_interface>Importing a cluster using the RHACM User Interface</a><ul class=pf-c-jump-links__list><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#_getting_to_the_rhacm_user_interface>Getting to the RHACM user interface</a></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#_importing_the_cluster>Importing the cluster</a></li></ul></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#_other_potential_import_tools>Other potential import tools</a></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#_importing_a_cluster_using_the_cm_cli_tool>Importing a cluster using the cm-cli tool</a></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#_importing_a_cluster_using_clusteradm_tool>Importing a cluster using <code>clusteradm</code> tool</a></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#_designate_the_new_cluster_as_a_devel_site>Designate the new cluster as a devel site</a></li></ul></li></ul></nav></aside></div></section><section id=prefooter class="pf-c-page__main-section footer-dark"><div class="pf-l-grid prefooter-menu-grid"><div class="pf-l-grid__item pf-m-12-col-on-sm pf-m-6-col-on-md pf-m-offset-1-col-on-md pf-u-mb-lg pf-u-mb-0-on-sm"><div class="pf-l-grid pf-u-py-xl"><div class="pf-l-grid__item pf-m-6-col-on-sm pf-m-4-col-on-md pf-u-ml-md pf-u-ml-0-on-md pf-u-mb-xl pf-u-mb-0-on-md"><p class="pf-c-title footer-menu-title">QUICKLINKS</p><nav aria-label="Quick Links"><ul class="pf-c-list pf-m-plain"><li><i class="prefooter-icon fa-brands fa-github"></i>
<a class=footer-link aria-label="GitHub repository" href=https://github.com/hybrid-cloud-patterns>GitHub repository</a></li><li><i class="prefooter-icon fas fa-check-circle"></i>
<a class=footer-link aria-label="Available patterns" href=/patterns>Available patterns</a></li></ul></nav></div><div class="pf-l-grid__item pf-m-6-col-on-sm pf-m-4-col-on-md pf-u-mt-lg pf-u-mt-0-on-sm pf-u-ml-md pf-u-ml-0-on-md pf-u-mb-xl pf-u-mb-0-on-md"><p class="pf-c-title footer-menu-title">CONTRIBUTE</p><nav aria-label=Contribute><ul class="pf-c-list pf-m-plain ws-org-pfsite-footer-menu-list"><li><i class="prefooter-icon fas fa-pen"></i>
<a class=footer-link aria-label="Documentation contributor guidelines" href=/contribute/contribute-to-docs/>Documentation</a></li><li><i class="prefooter-icon fas fa-code"></i>
<a class=footer-link aria-label="How to create a new pattern" href=/contribute/creating-a-pattern/>Patterns</a></li></ul></nav></div><div class="pf-l-grid__item pf-m-6-col-on-sm pf-m-4-col-on-md pf-u-mt-lg pf-u-mt-0-on-md pf-u-ml-md pf-u-ml-0-on-md"><p class="pf-c-title footer-menu-title">STAY IN TOUCH</p><nav aria-label="Stay in touch"><ul class="pf-c-list pf-m-plain"><li><i class="prefooter-icon fas fa-envelope"></i>
<a href=https://groups.google.com/g/hybrid-cloud-patterns class=footer-link target=top aria-label="Join the Validated Patterns mailing list">Mailing list</a></li></ul></nav></div></div></div><div class="pf-l-grid__item pf-m-12-col-on-sm pf-m-4-col-on-md"><div class="pf-l-grid pf-u-pt-xl"><div class="pf-l-grid__item pf-u-px-xl"><a class="pf-c-page__header-brand-link pf-c-brand pf-u-pb-md" href=/><img class=pf-c-brand src=/images/hybrid_cloud_patterns.png alt="Hybrid Cloud Patterns"></a><p class=footer-link>Hybrid Cloud Patterns are an evolution of how you deploy applications in a hybrid cloud. With a pattern, you can automatically deploy a full application stack through a GitOps-based framework. With this framework, you can create business-centric solutions while maintaining a level of Continuous Integration (CI) over your application.</p></div></div></div></div></section><footer id=footer class="footer-dark pf-m-no-fill pf-l-flex footer-center"><div class=pf-l-flex__item><a href=//www.redhat.com target=top aria-label="Visit Red Hat.com"><img src=/images/RHlogo.svg alt="Red Hat logo" width=145px height=613px></a><span class=site-copyright>Copyright &copy; 2023 Red Hat, Inc.</span></div><script src=/js/bootstrap.bundle.js></script></footer></main></div></body></html>